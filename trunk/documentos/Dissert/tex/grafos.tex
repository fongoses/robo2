%==========================================================
% Grafos e aplicações.
% 
% Autor
% Heitor Luis Polidoro
% 
% Orientador
% Prof. Dr. Denis Fernando Wolf
%==========================================================
\chapter{Grafos e Aplicações}
\label{grafos_aplicacoes}
Grafos e mapas topológicos, são muito utilizados na literatura para navegação de robôs móveis, como pode ser constatado em \cite{Adorno2005,Scatena2004,Thrun1996,Thrun1998,Thrun1998a,Neto2003}. Como o problema proposto (seção \ref{resultados}) diz respeito à busca de trajetória em um mapa topológico (grafo), uma das soluções se torna uma variação do problema do caixeiro viajante que trata, basicamente, de encontrar o menor ciclo hamiltoniano em um grafo.

As seções seguintes contém uma explicação sobre grafos, mapas topológicos, ciclo hamiltoniano e o problema do caixeiro viajante.

\section{Grafos}
\label{grafos}
Muitas aplicações em computação necessitam considerar um conjunto de conexões entre objetos. Os relacionamentos dessas conexões podem ser utilizados para responder questões como: Existe caminho de um objeto a outro? Quantos objetos podem ser alcançados a partir de um determinado objeto? Qual a menor distância entre dois objetos? Existe um tipo abstrato de dados chamado grafo que é usado para modelar essas situações \cite{Ziviani2004}.

Um grafo é constituído de um conjunto de vértices e um conjunto de arestas que conectam pares de vértices. Um vértice é um objeto que pode conter nomes e outros atributos. Os grafos podem ser direcionados ou não direcionados. Um grafo direcionado $G$ é um par $(V, A)$, em que $V$ é um conjunto finito de vértices e $A$ é um conjunto de arestas com uma relação binária. A Figura \ref{fig:grafo_dir} mostra um grafo direcionado com o conjunto de vértices $V = {0, 1, 2, 3, 4, 5}$ e de arestas $A = {(0, 1), (0, 3), (1, 2), (1, 3), (2, 2), (2, 3), (3, 0), (5, 4)}$. Em um grafo não direcionado as arestas $(u, v)$ e $(v, u)$ são consideradas as mesmas. A Figura \ref{fig:grafo_ndir} mostra um grafo não direcionado com o conjuntos de vértices $V = {0, 1, 2, 3, 4, 5}$ e de arestas $A = {(0, 1), (0, 2), (1, 2), (4, 5)}$. Em grafos direcionados podem existir arestas de um vértice para ele mesmo, chamadas de \textit{self-loops}, como a aresta $(2, 2)$ no grafo direcionado da Figura \ref{fig:grafo_dir} \cite{Ziviani2004}.

\begin{figure}[ht]
	\centering
	\subfigure[Grafo direcionado]{
		\includegraphics[width=0.2\textwidth]{../../imagens/grafo_direcionado.jpg}
		\label{fig:grafo_dir}}
	\subfigure[Grafo não direcionado]{
		\includegraphics[width=0.2\textwidth]{../../imagens/grafo_nao_direcionado.jpg}
		\label{fig:grafo_ndir}}
	\caption{Exemplo de grafos\cite{Ziviani2004}}
	\label{fig:exemplo_de_grafos}
\end{figure}

Em um grafo direcionado, a aresta $(u, v)$ sai do vértice $u$ e entra no vértice $v$. Se $(u, v)$ é uma aresta do grafo $G = (V, A)$, então o vértice $v$ é adjacente ao vértice $u$. Quando o grafo não é direcionado, a relação de adjacência é simétrica \cite{Ziviani2004}.

Em um grafo, um caminho $(v_0, v_1, \cdots, v_k)$ forma um ciclo se $v_0 = v_k$ e o caminho contém pelo menos uma aresta. O ciclo é simples se os vértices $v_1, v_2, \cdots, v_k$ são distintos. O \textit{self-loop} é um ciclo de tamanho 1. Na Figura \ref{fig:grafo_dir}, o caminho $(0, 1, 2, 3, 0)$ forma um ciclo. Dois caminhos $(v_0, v_1, \cdots, v_k)$ e $(v'_0, v'_1, \cdots, v'_k)$ formam o mesmo ciclo se existir um inteiro $j$ tal que $v'_i = v_{(j+i) mod k}$ para $i = 0, 1, \cdots, k - 1$. Na Figura \ref{fig:grafo_dir}, o caminho $(0, 1, 3, 0)$ forma o mesmo ciclo que os caminhos $(1, 3, 0, 1)$ e $(3, 0, 1, 3)$. Um grafo sem ciclos é um grafo acíclico \cite{Ziviani2004}.

Um grafo $G$ é definido como \textit{Hamiltoniano} se possui um ciclo contendo todos os vértices de $G$. Esse nome foi dado, porque, em 1856, Willian Rowan Hamilton inventou um jogo matemático que consistia em um dodecaedro no qual cada um dos vinte vértices recebeu o nome de uma cidade. O objetivo do jogo era viajar pelas arestas do dodecaedro, visitando cada cidade exatamente uma vez e retornando para o ponto inicial \cite{Beineke1978}. A Figura \ref{fig:dodecaedro_de_hamilton} mostra uma solução para o jogo.

\figura{../../imagens/dodecaedro_de_hamilton.jpg}{.5}{Dodecaedro de Hamilton.\cite{Beineke1978}}{fig:dodecaedro_de_hamilton}

Definições segundo Gondran, Minoux e Vajda \cite{Gondran1984}:

\begin{itemize}
	\item Um caminho passando somente uma vez em cada vértice de $G$ é chamado Caminho Hamiltoniano e tem comprimento de $N - 1$
	\item Um ciclo Hamiltoniano é um ciclo que passa somente uma vez em cada vértice de $G$ e tem comprimento $N$.
\end{itemize}

Um grafo não direcionado é conectado se cada par de vértices está conectado por um caminho. Um grafo direcionado é fortemente conectado se cada dois vértices quaisquer são alcançáveis a partir um do outro. Um grafo ponderado possui pesos associados às suas arestas. Esses pesos podem representar, por exemplo, custos ou distâncias. Um grafo completo é um grafo no qual todos os pares de vértices são adjacentes \cite{Ziviani2004}.

\section{Busca do Menor Caminho}
\label{busca_do_menor_caminho}
%
\subsection{Algoritmo de Dijkstra}
\label{algoritmo_de_dijkstra}
Existem diversos algoritmos para buscas em grafo na literatura \cite{Cormen2001}. O algoritmo de Dijkstra utiliza a técnica do relaxamento, que nada mais é que verificar se é possível melhorar o caminho obtido até o momento passando por um vértice diferente. O algoritmo de Dijkstra apresenta uma solução $O([m + n] × log(n))$ para a determinação do menor caminho \cite{Dudek2000}, e é composto por três passos:

\begin{itemize}
	\item Passo 1: Iniciar os valores:

\begin{algorithmic}
	\FORALL {$v \in V[G]$} 
	\STATE$	d[v] \gets \infty$
	\STATE$ \pi[v] \gets  nulo$
	\ENDFOR
	\STATE	$d[s] \gets 0$
\end{algorithmic}

	$V[G]$ é o conjunto de vértices $v$ que forma o grafo $G$.
	
	$d[v]$ é o vetor de distâncias do vértice $s$ até cada vértice $v$.
	
	$\pi[v]$ identifica o vértice de onde se origina uma conexão até $v$ de maneira a formar um caminho mínimo;

	\item Passo 2: Tem-se que usar dois conjuntos: $S$, que representa todos os vértices $v$ onde $d[v]$ já contém o custo do menor caminho e $Q$ que contém os vértices restantes;

	\item Passo 3: Realiza-se uma série de relaxamentos das arestas:
\begin{algorithmic}
	\WHILE {$Q \neq \emptyset $}
		\STATE$u \gets$ \texttt{extraia-mín($Q$)}
		\STATE $S \gets S \cup {u}$
		\FORALL{$v$ adjacente a $u$}
			\STATE se $d[v] > d[u] + w(u, v)$ então 
			\STATE $d[v] \gets d[u] + w(u, v)$
			\STATE $\pi[v] \gets u$
		\ENDFOR
	\ENDWHILE
\end{algorithmic}
		$w(u, v)$ é o peso da aresta que vai de $u$ a $v$.
		$u$ e $v$ são vértices quaisquer e $s$ é o vértice inicial.
		\texttt{extraia-mín($Q$)}, retorna o menor elemento.
		
\end{itemize}

\section{Caixeiro-Viajante}
\label{caixeiro}

O problema do caixeiro-viajante envolve um conjunto de cidades e é da classe de problemas de roteamento de nós, onde um caixeiro sai de uma cidade base, visita todas as cidades somente uma vez, e retorna à cidade base, otimizando um ou mais objetivos. Problemas de caixeiro-viajante são definidos em grafos orientados ou não orientados \cite{Arenales2007}.

A definição do problema do caixeiro-viajante é: Considera-se um grafo não orientado $G = (N, E)$, em que o conjunto $N$ consistem em $n$ cidades e $E$ representa o conjunto de arestas entre essas cidades. Supondo que $G$ é um grafo completo, isto é, para qualquer par de cidades $i, j \in \mathbb{N}, i \neq j$, existe uma aresta $(i, j)$. A distância entre as cidades $i$, e $j$ é $c_{ij}$, e quando $c_{ij} = c_{ji}$, o problema é dito simétrico. Um caixeiro deve visitar $n$ cidades, passando por cada cidade somente uma vez, e retornar à cidade de partida. Esse percurso é denominado ciclo Hamiltoniano do grafo $G$, e o problema consiste em determinar o ciclo Hamiltoniano, ou rota, de distância mínima. Devido à sua aplicação em diversas áreas, este é um dos problemas combinatórios mais pesquisados \cite{Arenales2007}.

Define-se as variáveis

\begin{center}
$
x_{ij}=\left\{ \begin{array}{l}
			1  \mbox{ se o caixeiro vai diretamente da cidade $i$ à cidade $j$}, i \neq j \\
			0  \mbox{ se o caixeiro não vai da cidade $i$ à cidade $j$}, i \neq j
		\end{array}\right.
$
\end{center}

E considera-se o seguinte modelo:

\begin{equation}
	\mbox{min}\sum_{i=1}^n \sum_{j > i}c_{ij}x_{ij} 
	\label{eq:cv-func_obj}
\end{equation}

\begin{equation}
	\sum_{j < i} x_{ji} + \sum_{j > i} x_{ij} = 2, i = 1, \cdots, n
	\label{eq:cv-restr1}
\end{equation}

\begin{equation}
	x \in B^{n(n-1)/2}
	\label{eq:cv-restr2}
\end{equation}

A função objetivo (\ref{eq:cv-func_obj}) expressa a minimização da distância total da rota, e a restrição (\ref{eq:cv-restr1}) impõe que cada cidade tenha somente uma cidade sucessora imediata e uma cidade predecessora imediata, ou seja, é visitada uma única vez. Uma solução para o modelo anterior pode gerar sub-rotas desconexas (Figura \ref{fig:sub-rotas}) \cite{Arenales2007}.

\figura{../../imagens/sub-rotas.jpg}{.4}{Exemplo de possíveis sub-rotas.\cite{Arenales2007}}{fig:sub-rotas}

Seja $S$ uma sub-rota, por exemplo, $S = {1. 2. 3. 4}$ na Figura \ref{fig:sub-rotas}. A eliminação de sub-rotas pode ser obtida através da restrição:
\begin{equation}
	\sum_{i \in S} \sum_{i \ in S \\ j > i} \leq |S| - 1, S \subset \mathbb{N}, 3 \leq |S| \leq \left\lfloor \frac{n}{2} \right\rfloor
	\label{eq:cv-el_sub-rotas1}
\end{equation}
Que garante que, para cada conjunto $S$, existem no mínimo duas arestas que entram e/ou saem de $S$, ou seja, existem no mínimo duas arestas entre cidades de $S$ e cidades fora de $S$. A cardinalidade de $S$ é no mínimo 3 (pois ciclo em um grafo não orientado tem pelo menos 3 vértices) e no máximo $\left\lfloor\frac{n}{2}\right\rfloor$, pois ao se eliminar ciclos com $k$ vértices, elimina-se ciclos com $n - k$ vértices. A sub-rota $S = {1, 2, 3, 4}$ é eliminada.
\begin{center}
	$x_{15} + x_{16} + x_{17} + x_{25} + x_{26} + x_{27} + x_{35} + x_{36} + x_{37} + x_{45} + x_{46} + x_{47} \geq 2$
\end{center}


Como o número de subconjuntos distintos de um conjunto de cardinalidade $k$ é $2^k$, a restrição \ref{eq:cv-el_sub-rotas1} %e \ref{eq:cv-el_sub-rotas2}
têm cardinalidade da ordem de $2^k$, $k \geq 6$, ou seja, o crescimento é exponencial em função do número de cidades. Para $k \leq 5$, a restrição \ref{eq:cv-restr1} elimina sub-rotas \cite{Arenales2007}.

\section{Considerações}
\label{consideracoes_grafo}

Como o mapa que é utilizado no projeto é um mapa baseado em grafo (mapa topológico), é possível utilizar algumas teorias de grafos presentes na literatura como base para se achar uma solução para o problema. Assim como, foi utilizado o algoritmo de Dijkstra nas buscas de menor caminho para o robô fazer a menor trajetória de um vértice a outro, e a fundamentação matemática da teoria do caixeiro-viajante que foi utilizada como base para se achar uma solução \textit{offline}.