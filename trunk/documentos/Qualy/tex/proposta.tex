%==========================================================
% SCE=567 Projeto Supervisionado ou de Graduação II
% 
% Capitulo 3: Proposta.
% 
% Autor
% Heitor Luis Polidoro
% 
% Orientador
% Prof. Dr. Denis Fernando Wolf
%==========================================================

\chapter{Proposta}
\label{proposta}

\section{Objetivo}
\label{objetivo}
Essa dissertação tem como objetivo o desenvolvimento de uma estratégia eficiente para determinar uma seqüência de áreas a serem visitadas em ambientes internos com a finalidade de monitoramento desses ambientes utilizando um robô móvel. O problema a ser resolvido consiste na divisão de um ambiente previamente conhecido em áreas de interesse (exemplo na Figura \ref{fig:mapa_museu}). A cada uma dessas áreas é atribuído um valor (peso) referente a sua importância de monitoramento (exemplo na Tabela \ref{tab:prioridade_museu}). A prioridade com que o robô deve visitar determinadas áreas é calculada com base na importância dessas áreas e no tempo decorrido desde a sua última visita. Áreas de maior importância devem ser visitadas mais freqüentemente. 

\figura{imagens/MUSEU_DO_HOMEM_SERGIPANO.jpg}{8}{Museu do homem sergipano e suas divisões}{fig:mapa_museu}

\begin{table}\begin{center}
	\begin{tabular}
		{|c|c|}
		\hline
		Sala & Prioridade \\
		\hline
		a& 5 \\
		b& 5 \\
		c& 2 \\
		d& 1 \\
		e& 3 \\
		f& 2 \\
		g& 1 \\
		h& 2 \\
		i& 2 \\
		j& 4 \\
		k& 4 \\
		l& 4 \\
		1& 2 \\
		2& 3 \\
		3& 3 \\
		4& 5 \\
		5& 5 \\
		6& 5 \\
		7& 4 \\
		8& 4 \\
		9& 3 \\
		\hline
	\end{tabular}
\end{center}
\caption{Exemplo de prioridades}
\label{tab:prioridade_museu}
\end{table}

\subsection{Critérios de Avaliação}
\label{criterios}
Os algoritmos e estratégias serão então testados e avaliados. As avaliações consistem na comparação dos algoritmos e estratégias. Serão utilizados dois critérios de comparação, um critério comparando a freqüência relativa de cada sala com sua prioridade relativa, onde o melhor resultado é aquele em que a freqüência relativa se aproximar mais da prioridade relativa, pois se uma sala (a) possui uma prioridade com valor duas vezes maior que uma sala (b) (Salas f e 7 na Figura \ref{tab:prioridade_museu} por exemplo), a sala (a) deve ser visitada com o dobro de freqüência do que a sala (b). Isto indica que o algoritmo ou estratégia se manteve fiel à definição do problema \textit{ Áreas de maior importância devem ser visitadas mais freqüentemente.}.

O segundo critério é um gráfico mostrando a progressão da somatória dos graus de urgência de todas as salas $(\sum_{i=0}^n U_i)$ , no qual o melhor resultado consiste em manter o menor valor da somatória dos graus de urgência. Mostrando que o algoritmo ou estratégia visitou as salas com maior eficiência. O grau de urgência $U$ é calculado multiplicando-se a prioridade da sala $P$ pelo tempo decorrido desde a última visita $t$. A casa visita o $t$ é zerado $(U_i = P_i \times t_i)$.

%\section{Resultados Esperados}
%\label{resultados_esperados}
%Com nesta dissertação de mestrado espera-se encontrar um algoritmo ou estratégia que determine a melhor forma de monitorar um ambiente interno para aplicação em vigilância, hospitais entre outros.
%
\section{Metodologia}
\label{metodologia}
Para o desenvolvimento do projeto, será utilizado a biblioteca Player (apresentado na seção \ref{player}) e o simulador Stage (apresentado na seção \ref{stage}). O projeto será implementado em C++. Será utilizado o método de Voronoi para padronizar e automatizar a geração dos mapas topológicos.

Cada ambiente terá um mapa topológico que será gerado utilizando o diagrama de Voronoi. O robô então, deve utilizar deste mapa para se locomover de uma sala para outra no ambiente. Para os algoritmos e estratégias determinarem a seqüência de salas à visitar, será considerado um grafo completo com todas as salas, pois para determinar o melhor caminho entre uma sala e outra será utilizado o algoritmo de Dijkstra no mapa topológico.

Como um dos critérios de avaliação está relacionado ao tempo que o robô fica sem visitar as salas é possível deduzir que a solução seja um ciclo.

\pagebreak

Considere:
\begin{itemize}
	\item Um ambiente com $S$ salas;
	\item Um ciclo hamiltoniano $C$ qualquer;
	\item $C_i$ é a i-ésima sala visitada no ciclo;
	\item Uma velocidade constante do robô;
	\item O não gasto de tempo para o robô virar, ou seja ele vira instantaneamente.
	\item $\Delta t_i$ o tempo para sair da sala $i$ e chegar na sala $i+1$	
\end{itemize}

Como o tempo de viagem de uma sala à outra é constante todos os $\Delta t_i$ são constantes, portanto o tempo total do ciclo $T$ é constante $(\sum_{i=1}^S \Delta t_i = cte)$. Se o tempo do ciclo é constante o tempo que o robô demora para revisitar cada sala é constante igual a $T$. Mas isso não é interessante para solução do problema pois o grau de urgência de cada sala é diferente, então se uma sala tem uma prioridade muito alta, seu grau de urgência vai ser muito alto até o robô revisitá-la. 

Para resolver esse problema, basta fazer com que o robô revisite essa(s) sala(s) mais de uma vez no ciclo. Então supondo um ciclo de tamanho $n$ sendo $n \geq S$ o tempo total do ciclo continua constante $(\sum_{i=1}^n \Delta t_i = cte)$. Portanto a solução do problema consiste em encontrar esse ciclo.

Outro método para encontrar a solução do problema é se basear em algum problema existente na literatura. Como o problema é encontrar um ciclo em um grafo minimizando o tempo para revisitar as salas. É possível utilizar a formulação matemática do caixeiro viajante e modificá-la para modelar o problema proposto nesta dissertação.

\section{Plano de Trabalho}
\label{plano}

\renewcommand{\labelenumi}{\textbf{Fase \arabic{enumi}: }}

\begin{enumerate}
	\item \label{creditos}\textbf{Cumprimento dos créditos referente às disciplinas do mestrado} \\
		Concluído em dezembro de 2008.

	\item \label{revisao}\textbf{Revisão bibliográfica} \\
		A revisão bibliográfica foi iniciada durante o projeto da disciplina \textit{SCE567 Projeto Supervisionado ou de Graduação I} e \textit{II} no qual foi dado início ao projeto homônimo para conclusão do curso de graduação. Foi revisado no ano de 2008, juntamente com as disciplinas de mestrado, intensificado no final do segundo semestre de 2008 e início de 2009. E terá atualizações periódicas no decorrer do desenvolvimento da dissertação.

	\item \label{monitoria}\textbf{Monitoria} \\
		Nessa fase o candidato auxiliará o professor da disciplina escolhida visando o aprofundamento do conhecimento na área.

	\item \label{PAE}\textbf{Programa de Aperfeiçoamento de ensino} \\
		O candidato deverá exercer funções na área acadêmica para aperfeiçoamento do candidato na área de ensino.

	\item \label{qualy}\textbf{Redação da mini-dissertação para exame de qualificação}	\\
		A redação da mini-dissertação foi concluída em fevereiro de 2009, com o exame de qualificação marcado para março de 2009.

	\item \label{desenvolvimento}\textbf{Desenvolvimento de estratégias e algoritmos para determinação da seqüência de salas a visitar}
		Alguns algoritmos já foram desenvolvidos empiricamente (Algoritmo \ref{alg:1} e Algoritmo \ref{alg:2}), nesta fase o candidato deverá desenvolver outros algoritmo e estratégias para determinar a seqüência de salas a visitar.

	\item \label{comparacao}\textbf{Comparações entre os algoritmo e estratégias} \\
		Nesta fase o candidato deve avaliar e comparar os algoritmo e estratégias em diversos tipos de mapas com topologias, tamanhos e conectividades diferentes, e utilizando os critérios descritos em \ref{criterios} determinar qual algoritmo ou estrategia é mais eficiente em cada caso utilizando ferramentas matemáticas para validar as conclusões.

	\item \label{seminario}\textbf{Apresentação de seminários} \\
		Serão apresentados seminários para os membros do grupo dos resultados obtidos com a finalidade de discutir sobre os mesmos.

	\item \label{artigos}\textbf{Elaboração de artigos científicos} \\
		Artigos científicos deverão ser elaborados para divulgar os resultados obtidos no decorrer da dissertação.

	\item \label{dissertacao}\textbf{Redação de dissertação} \\
		Nesta fase o candidato deverá redigir a dissertação de mestrado contendo a revisão bibliográfica atualizada e os resultados obtidos na dissertação.

\end{enumerate}

\renewcommand{\labelenumi}{\arabic{enumi}}

\subsection{Cronograma}
\label{cronograma}
\definecolor{CinzaMalasiano}{rgb}{0.4, 0.4, 0.4} 
	
\newcommand{\y} {\color{CinzaMalasiano}  \hspace*{6pt} \rule{6pt}{6pt} \hspace*{6pt} }
\newcommand{\x}{\hspace*{6pt}}
\setlength{\tabcolsep}{1pt}
 
\begin{table}[!ht] \footnotesize
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|}
  \cline{2-13}
  \multicolumn{1}{l|}{} & \multicolumn{5}{c|}{{\bf 2008}} &
\multicolumn{6}{c|}{{\bf 2009}} & {\bf 2010} \\
  \cline{2-13}
  \multicolumn{1}{c|}{\textbf{Fase}} & \rotatebox{90}{Mar - Abr\hspace{3pt}} & \rotatebox{90}{Mai - Jun\hspace{3pt}} &
                        \rotatebox{90}{Jul - Ago\hspace{3pt}} & \rotatebox{90}{Set - Out\hspace{3pt}} &
                        \rotatebox{90}{Nov - Dez\hspace{3pt}} & \rotatebox{90}{Jan - Fev\hspace{3pt}} &
                        \rotatebox{90}{Mar - Abr\hspace{3pt}} & \rotatebox{90}{Mai - Jun\hspace{3pt}} &
                        \rotatebox{90}{Jul - Ago\hspace{3pt}} & \rotatebox{90}{Set - Out\hspace{3pt}} &
                        \rotatebox{90}{Nov - Dez\hspace{3pt}} & \rotatebox{90}{Jan - Fev\hspace{3pt}}  \\
  \hline
	\ref{creditos} & 
	\y & \y & \y & \y & \y &   \x & \x & \x & \x & \x & \x &   \x \\
  \hline

	\ref{revisao} &
	\y & \y & \y & \y & \y &   \y & \y & \y & \y & \y & \y &   \x \\
  \hline

	\ref{monitoria} &
	\y & \y & \x & \x & \x &   \y & \y & \x & \x & \x & \x &   \x \\
  \hline

	\ref{PAE} &
	\x & \x & \y & \y & \y &   \x & \y & \y & \y & \x & \x &   \x \\
  \hline

	\ref{qualy} &
	\x & \x & \x & \x & \y &   \y & \x & \x & \x & \x & \x &   \x \\
  \hline

	\ref{desenvolvimento} &
	\x & \x & \x & \x & \x &   \x & \y & \y & \y & \y & \x &   \x \\
  \hline

	\ref{comparacao} &
	\x & \x & \x & \x & \x &   \x & \x & \y & \y & \y & \y &   \x \\
  \hline

	\ref{seminario} &
	\x & \x & \x & \x & \x &   \x & \x & \x & \y & \y & \y &   \x \\
  \hline

	\ref{artigos} &
	\x & \x & \x & \x & \x &   \x & \x & \x & \y & \y & \y &   \y \\
  \hline

	\ref{dissertacao} &
	\x & \x & \x & \x & \x &   \x & \x & \x & \x & \y & \y &   \y \\
  \hline

\end{tabular}
 \caption{Cronograma Proposto.}
 \label{tab:Cronograma}
 \normalsize
\end{center}
\end{table}


\section{Resultados Parciais}
\label{resultados_parciais}
Como a dissertação de mestrado é a continuação do projeto de graduação, alguns resultados parciais podem ser destacados. Foram implementados dois algoritmos. O algoritmo 1 (Algoritmo \ref{alg:1}) verifica qual sala que possui o maior grau de urgência e manda o robô visitar aquela sala. O algoritmo 2 (Algoritmo \ref{alg:2}) manda o robô visitar a sala que possui o maior grau de urgência visitando as salas que são adjacentes à algum vértice da trajetória até a sala destino. 

\begin{algorithm}
\caption{Algoritmo 1}
\label{alg:1}
\begin{algorithmic}[1]
	\STATE $sala \Leftarrow sala\_inicial$
	\LOOP
		\STATE Visita sala atual //Zera o $t$ da sala atual na tabela
		\STATE $sala \Leftarrow$ sala\_de\_maior\_grau\_de\_urgência()
		\STATE Vai para $sala$
	\ENDLOOP
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
\caption{Algoritmo 2}
\label{alg:2}
\begin{algorithmic}[1]
	\STATE $sala \Leftarrow SALA\_INICIAL$
	\LOOP
		\STATE Visita sala atual //Zera o $t$ da sala atual na tabela
		\STATE $sala \Leftarrow$ sala\_de\_maior\_grau\_de\_urgência()
		\STATE Vai para $sala$
		\FORALL{vértice no caminho}
			\FORALL{Sala adjacente ao vértice}
				\STATE Vai para sala adjacente
				\STATE Visita a sala //Zera o $t$ da sala adjacente na tabela
				\STATE Volta para o vértice
			\ENDFOR
		\ENDFOR
	\ENDLOOP
\end{algorithmic}
\end{algorithm}

Os algoritmo são bem parecidos, a diferença principal é que no algoritmo 1 o robô verifica qual sala tem maior grau de urgência, transita até a sala, visita a sala, ou seja, zera o seu grau de urgência, só então verifica qual a próxima sala com maior grau de urgência e assim sucessivamente. No algoritmo 2 o robô também verifica qual sala tem maior grau de urgência e transita até a sala, mas se houver alguma sala adjacente um vértice do caminho do robô, o robô visita essa tala também.

O mapa que foi utilizado para teste está na Figura \ref{fig:mapa_rep}, cujas prioridades estão descritas na Tabela \ref{tab:prioridade_rep}.
\figura{imagens/mapa_rep.jpg}{.5}{Mapa 1.}{fig:mapa_rep}

\begin{table}
\begin{center}
	\begin{tabular}{|c|c|c|}
	\hline
	Sala & Prioridade\\
	\hline
	1 & 9\\
	\hline
	2 & 2\\
	\hline
	3 & 9\\
	\hline
	4 & 4\\
	\hline
	5 & 9\\
	\hline
	6 & 6\\
	\hline
	7 & 2\\
	\hline
	8 & 9\\
	\hline
	9 & 6\\
	\hline
	10 & 7\\
	\hline
	11 & 1\\
	\hline
	12 & 2\\
	\hline
	13 & 4\\
	\hline
	\end{tabular}
\caption{Prioridades do Mapa 1}
\label{tab:prioridade_rep}
\end{center}
\end{table}

A Figura \ref{fig:trajetoria_rep_12}\subref{fig:alg1_map1} e a Figura \ref{fig:trajetoria_rep_12}\subref{fig:alg2_map1} mostram as trajetórias do robô no Mapa 1 utilizando o Algoritmo 1 e Algoritmo 2 respectivamente. O robô inicia o teste sempre na sala 5.

\begin{figure}[ht]
	\centering
	\subfigure[Algoritmo 1]{
		\includegraphics[width=0.4\textwidth]{imagens/rep_alg1_atu30_tot30.jpg}
		\label{fig:alg1_map1}}
	\subfigure[Algoritmo 2]{
		\includegraphics[width=0.4\textwidth]{imagens/rep_alg2_atu30_tot30.jpg}
		\label{fig:alg2_map1}}
		
		\caption{Trajetória dos algoritmos 1 \subref{fig:alg1_map1} e 2 \subref{fig:alg2_map1}}
	\label{fig:trajetoria_rep_12}
\end{figure}

O gráfico de graus de urgência demonstrado na Figura \ref{fig:resultado}. É o resultado de uma simulação de três horas de cada algoritmo no mapa. O resultado mostra que pelo critério de grau de urgência total, o algoritmo 2 foi mais eficiente do que o algoritmo 1. Mas independente de qual algoritmo foi melhor, pelo gráfico é possível notar uma tendência de estabilidade de cada algoritmo, ou seja, cada algoritmo mantém o grau de urgência total em uma faixa de valores depois de um certo tempo, isto indica que pode haver um ciclo na seqüência de salas visitadas, se existe esse ciclo pode ser possível a determinação do mesmo \textit{offline}.

\figura{imagens/resultados.jpg}{.4}{Resultado parcial da comparação dos algoritmos 1 e 2}{fig:resultado}

\pagebreak

\section{Considerações Finais}
\label{consideracoes_finais}
Em uma primeira análise do problema achou-se que a solução seria somente uma decisão do robô em tempo real para determinar a seqüência de salas a visitar, mas após alguns testes com algoritmos definidos de modo empírico para entender melhor o problema, foi visto que mesmo os algoritmos possuindo performances bem distintas, eles mostraram um padrão no comportamento, sendo assim, possível visualizar que a solução do problema pode ser encontrada em uma busca \textit{offline} no grafo, uma vez que todo o ambiente é previamente conhecido.

