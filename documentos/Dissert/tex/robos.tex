%==========================================================
% Robôs Móveis.
% 
% Autor
% Heitor Luis Polidoro
% 
% Orientador
% Prof. Dr. Denis Fernando Wolf
%==========================================================

\chapter{Robôs Móveis}
\label{robos}

Este capítulo apresenta as principais características dos Robôs Móveis Autônomos. Um robô móvel autônomo é dotado de três características importantes: Ativadores, responsáveis, entre outras coisas pela locomoção; Sensores, que fazem o papel da percepção do robô e Controle, que aciona os ativadores de acordo com a leitura dos sensores, seguindo o propósito para qual o robô está sendo utilizado.

\section{Locomoção}
\label{locomocao}
Robôs móveis precisam de mecanismos de locomoção que os permitam moverem-se livremente pelo ambiente, mas existe uma grande variedade de modos de se locomover: andar, pular, correr, deslisar, patinar, nadar ou voar, utilizando rodas ou esteiras \cite{Siegwart2004}. A maioria dos mecanismos de locomoção são inspirados na natureza, exceto os que usam rodas, esteiras ou propulsão (aquática ou aérea).

Robôs com rodas são os mais populares por inúmeras razões. Eles são mecanicamente simples de construir. A razão da carga peso/mecanismo é favorável. Os outros mecanismos geralmente precisam de um hardware mais complexo para carregarem a mesma carga \cite{Jones1999}. São mais eficientes em gasto de potência por velocidade como mostra a Figura \ref{fig:potencia_por_velocidade}. Além disso, como os robôs com rodas são projetados para três ou mais rodas estarem em contato com o chão todo o tempo, o equilíbrio não é usualmente um problema pesquisado \cite{Siegwart2004}.

\figura{../../imagens/grafico_potencia_por_velocidade.png}{.5}{Potência por velocidade de vários mecanismos de locomoção: (a) Rastejar e deslizar. (b) Correr. (c) Pneu em chão suave. (d) Andar. (e) Em ferrovia. (1) Unidade de potência (Cavalos/toneladas). (2) Velocidade (milhas/hora)\cite{Siegwart2004}.}{fig:potencia_por_velocidade}

Ao invés de se preocuparem com o equilíbrio, as pesquisas em robôs com rodas tendem a focar em problemas como tração, estabilidade, manobrabilidade e controle \cite{Siegwart2004}. 

Existem quatro classes principais de rodas, como é mostrado na Figura \ref{fig:tipos_de_rodas}. Elas se diferenciam grandemente na sua cinemática, e portanto, a escolha da classe de roda tem um grande impacto na cinemática do robô móvel. A roda padrão e a roda castor têm um eixo primário de rotação e são portanto altamente direcionais. Para mover em uma direção diferente, a roda precisa ser direcionada primeiro ao longo do eixo vertical. A diferença entre essas duas rodas é que a roda padrão consegue concluir seu direcionamento sem efeitos colaterais; porque o centro de rotação passa pelo contato com o chão, ao passo que a roda castor rotaciona em torno de um eixo deslocado, causando uma força a ser transmitida para o chassi do robô durante o direcionamento \cite{Siegwart2004}.

\figura{../../imagens/tipos_de_roda.png}{.6}{Quatro tipos básicos de roda. (a) Roda padrão. (b) Roda castor. (c) Roda sueca. (d) Bola ou roda esférica\cite{Siegwart2004}.}{fig:tipos_de_rodas}

As funções da roda sueca são as de uma roda normal, mas provêm baixa resistência em outra direção, algumas vezes perpendicular à direção convencional, como a Sueca 90, e algumas vezes em um ângulo intermediário, como a Sueca 45. Os pequenos roletes ao redor da roda são passivos. A vantagem principal desse modelo é que enquanto a rotação é provida somente através de um eixo principal, a roda pode cinematicamente mover-se com pouco atrito em diferentes possíveis trajetórias, não somente para frente e para trás \cite{Siegwart2004}.

A roda esférica é uma roda omnidirecional verdadeira, muitas vezes projetada de modo que ela possa ser alimentada ativamente para girar ao longo de qualquer direção. Um modo para implementar a roda esférica é imitar o \textit{mouse} do computador, provendo ativamente rolamentos alimentados que encostam na superfície superior da esfera e concedem força rotacional \cite{Siegwart2004}.

A principal desvantagem das rodas é que elas necessitam de uma rua ou uma superfície relativamente plana \cite{Braunl2008}, sendo que em terrenos desiguais, elas podem ter uma performance pobre. Genericamente, se a altura do objeto for aproximadamente o raio da roda a roda não consegue passar sobre esse objeto. Uma solução simples seria utilizar rodas grandes o suficiente, mais que o dobro da altura de quaisquer possíveis obstáculos, mas em muitos casos isso é impraticável \cite{Jones1999}.

\section{Sensores}
\label{sensores}
Uma das tarefas mais importantes em um sistema autônomo de qualquer tipo é adquirir conhecimento sobre o ambiente. Isso é feito adquirindo medidas usando vários sensores e extraindo informações significativas dessas medidas \cite{Siegwart2004}. Existe um vasto número de sensores sendo usados em robótica, aplicando diferentes técnicas de medidas e usando diferentes interfaces \cite{Braunl2008}. Como humanos, nós conseguimos ver uma xícara em cima da mesa e, sem pensar muito, conseguimos pegar essa xícara. De fato, completar a simples tarefa de alcançar e erguer uma xícara requer uma combinação complexa de sensores, interpretação, cognição e coordenação \cite{Jones1999}.

Alguns sensores são utilizados para medidas simples como a temperatura interna do robô ou a velocidade de rotação dos motores, mas outros mais sofisticados podem ser utilizados para adquirir informação sobre o ambiente ou até para medir diretamente a posição global do robô \cite{Siegwart2004}. 

Pode-se classificar os sensores em dois importantes eixos funcionais: proprioceptivo/exteroceptivo e passivo/ativo \cite{Siegwart2004}.
\textbf{Proprioceptivos} são os sensores que medem valores internos ao sistema, como velocidade do motor, voltagem bateria, ângulo dos braços por exemplo.
\textbf{Exteroceptivos} são os sensores que adquirem informações sobre o ambiente do robô, como medidas de distância, intensidade de luz e amplitude do som, por exemplo. Conseqüentemente, as medidas de sensores exteroceptivos são interpretadas pelo robô para extrair as informações significantes do ambiente.
\textbf{Passivos} são sensores que medem parâmetros do ambiente que entram no sensor. Por exemplo: sondas de temperatura, microfones e câmeras.
\textbf{Ativos} são sensores que emitem energia para o ambiente, então medem a reação do ambiente à essa energia. Sensores deste tipo têm uma performance superior, entretanto, existem alguns riscos, como a falta de energia, que pode afetar a característica que o sensor está tentando medir. Sensores ativos também podem sofrer interferências de sinais que estão fora do seu controle. Por exemplo, sinais emitidos por robôs próximos ou sensores similares no mesmo robô, podem influenciar no resultado das medidas. Exemplos de sensores ativos incluem sensores ultra-sônicos, sonares, e LASERs para medir distância \cite{Siegwart2004}. 

\subsection{Odômetro}
\label{odometro}
O odômetro é um sensor proprioceptivo que mede as rotações das rodas e baseado nessa informação é possível determinar a posição do robô no mapa. O principal problema dos odômetros é com relação à sua precisão, pois muitos fatores podem atrapalhar a leitura, como por exemplo, uma roda patinando ou um pneu murcho poderá fazer com que o odômetro interprete que o robô esteja fazendo um movimento diferente do real. Para corrigir esse tipo de problema existem os algoritmos de localização, que serão explicados em \ref{localizacao}.

\subsection{LASER}
\label{laser}
O LASER é um sensor Exteroceptivo Ativo, pois ele emite um sinal de luz e calcula a distância do objeto em relação ao sensor. Um emissor envia o sinal e calcula o tempo que esse sinal demora para retornar ao emissor, com isso é possível calcular a distância naquela direção, e através de um espelho rotativo é possível atingir até $360^\circ$ de alcance. A Figura \ref{fig:laser} mostra um LASER $180^{\circ}$.

\begin{figure}[h]
	\centering
		\includegraphics[width=0.30\textwidth]{../../imagens/laser.png}
	\caption{Exemplo de Funcionamento do LASER}
	\label{fig:laser}
\end{figure}

\section{Robô Pioneer}
\label{robo_pioneer}

O Pioneer 3 DX (Figura \ref{fig:pioneer}) é o robô disponível para testes experimentais no Laboratório de Robótica Móvel (ICMC - USP), ele é um robô móvel ágil e versátil. Construído em um sistema cliente-servidor, ele oferece um processamento de visão \textit{onboard}, comunicação \textit{ethernet}, LASER, GPS, sonar, e outras funções autônomas. Para programá-lo deve-se utilizar a biblioteca Player \cite{MobileRobots}.

O Pioneer 3 DX pode carregar até 23kg, chega até 1.6 m/s, possui rodas de 19cm, oito sonares na parte frontal e um computador interno com algumas funções já implementadas, como a utilizada no projeto que é o desvio de obstáculos utilizando o algoritmo VFH (\textit{Vector Field Histogram} explicado na seção \ref{VFH}).

\figura{../../imagens/pioneer.jpg}{.9}{Robô Pioneer.}{fig:pioneer}


\section{Player}
\label{player}
O Player é um servidor de rede para controlar robôs. Executando embarcado no robô, o Player provê uma interface simples e clara dos sensores e atuadores do robô sobre uma rede IP. O programa cliente ``conversa'' com o Player utilizando sockets TCP, lendo dados dos sensores, escrevendo comandos nos atuadores e configurando dispositivos em tempo de execução.
O servidor Player foi desenvolvido para que seus clientes sejam independentes de linguagem e de plataforma. O programa cliente pode ser executado em qualquer máquina que tenha conexão de rede com o robô, e pode ser escrito em qualquer linguagem que suporte sockets TCP. Atualmente existem clientes disponíveis em C++, Tcl, Java e Phyton \cite{Player}. Futuramente o Player será indiferente sobre como o programa de controle do robô é estruturado, ou seja, poderá escrever desde programas \textit{multi-threads} altamente concorrentes até programas sequencias simples.

\subsection{Interface dos Drivers}
\label{player_interface}
Usualmente as interfaces entre o programa do usuário e o robô se dá como mostra a Figura \ref{fig:interface_usual}, onde o programa do usuário tem que fazer a aquisição de dados diretamente dos sensores e tratar esses dados de modo que o planejador compreenda. E gerar os comandos para o motor ou outros atuadores. Sendo que para cada modelo de motor, os comandos são diferentes, assim como cada câmera, LASER e outros sensores têm leituras diferentes de acordo com o modelo.

\begin{figure}[hb]
	\centering
		\includegraphics[width=1.00\textwidth]{../../imagens/player1.png}
	\caption{Interface usual.}
	\label{fig:interface_usual}
\end{figure}

O Player tem como função fazer essa interface entre os sensores e atuadores e o programa do usuário (Figura \ref{fig:player_interface}), adquirindo os dados de qualquer modelo de um mesmo sensor (que seja aceito pelo Player) e fornecendo ao programa do usuário os dados já tratados, ou seja, para qualquer modelo de um mesmo sensor (que seja aceito pelo Player) o programa do usuário lê da mesma forma, assim como para os atuadores como mostra a Figura \ref{fig:modelo_cliente_servidor}. Por exemplo, para fazer com que o robô ande para frente na velocidade de 1 m/s, basta o programa do usuário informar a direção e velocidade, o comando vai ser o mesmo para diversos modelos de robôs, que possuem tamanhos e números de rodas diferentes, o que realiza os cálculos para determinar qual a rotação da roda para atingir tal velocidade é a interface do Player, assim como para ler do sensor LASER, basta informar de qual ângulo quer ler.

\begin{figure}[hb]
	\centering
		\includegraphics[width=1.00\textwidth]{../../imagens/player2.png}
	\caption{Interface do Player}
	\label{fig:player_interface}
\end{figure}

\begin{figure}[hb]
	\centering
		\includegraphics[width=1.00\textwidth]{../../imagens/modelo_cliente_servidor.png}
	\caption{Interface e Modelo Cliente-Servidor}
	\label{fig:modelo_cliente_servidor}
\end{figure}

A Figura \ref{fig:modelo_cliente_servidor} também ilustra o funcionamento do modo Cliente-Servidor do Player, como a comunicação é feita por meio de \textit{sockets} o programa cliente pode ser escrito em qualquer lingüagem que permita comunicação através de \textit{sockets}. Esse modo Cliente-Servidor também permite a fácil utilização de diversos simuladores, pois como a comunicação é a mesma, o programa cliente não sabe se está interagindo com o robô real ou com algum simulador (Figura \ref{fig:abstracao_de_hardware}).

\begin{figure}[hb]
	\centering
		\includegraphics[width=1.00\textwidth]{../../imagens/abstracao_de_hardware.png}
	\caption{Abstração de Hardware}
	\label{fig:abstracao_de_hardware}
\end{figure}

Esse modelo Cliente-Servidor também trás outras vantagens como:

\begin{itemize}
	\item Clientes podem se conectar a múltiplos servidores;
	\item Servidores aceitam conexão de múltiplos clientes;
	\item Diferentes programas/processos/\textit{threads} podem processar dados de diferentes sensores do mesmo servidor.
\end{itemize}

A Figura \ref{fig:exemplo_cliente_servidor} ilustra esse funcionamento, onde a letra 'P' indica que naquele dispositivo existe um programa Player sendo executado e a letra 'C' indica que naquele dispositivo está sendo executado um programa cliente.

\begin{figure}[hb]
	\centering
		\includegraphics[width=1.00\textwidth]{../../imagens/exemplo_cliente_servidor.png}
	\caption{Exemplo de Clientes e Servidores}
	\label{fig:exemplo_cliente_servidor}
\end{figure}

\section{Stage}
\label{stage}
O Stage é usado normalmente como um \textit{plugin }para o Player, provendo uma série de dispositivos virtuais para os clientes Player. Os usuários escrevem as rotinas e algoritmos normalmente, como clientes para um servidor Player. Não é possível para clientes distinguir a diferença entre os dispositivos reais do robô e os equivalentes simulados pelo Player/Stage. Com isso clientes Player desenvolvidos usando o Stage precisarão de pouca ou nenhuma modificação para trabalhar com o robô real e vice-versa. Em muitos casos, basta somente mudar no cliente o endereço IP de onde está o servidor. O Stage também pode simular uma população de robôs móveis, sensores e objetos num ambiente bidimensional (Figura \ref{fig:stage}) \cite{Player}. Nesta dissertação será utilizado somente um robô e o sensor LASER.

\figura{../../imagens/stage.jpg}{.5}{Simulação com 5 robôs, 2 objetos, LASER, sonar e \textit{blobfinder}.}{fig:stage}
